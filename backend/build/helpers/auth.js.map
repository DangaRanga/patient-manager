{"version":3,"sources":["../../src/helpers/auth.js"],"names":["auth","request","response","next","token","header","status","json","msg","verified","process","env","JWT_SECRET","user","id","err","res","error","message"],"mappings":";;;;;;;AAAA;;AAEA,IAAMA,IAAI,GAAG,SAAPA,IAAO,CAACC,OAAD,EAAUC,QAAV,EAAoBC,IAApB,EAA6B;AACxC,MAAI;AACF,QAAMC,KAAK,GAAGH,OAAO,CAACI,MAAR,CAAe,gBAAf,CAAd;;AACA,QAAI,CAACD,KAAL,EAAY;AACV,aAAOF,QAAQ,CACZI,MADI,CACG,GADH,EAEJC,IAFI,CAEC;AAAEC,QAAAA,GAAG,EAAE;AAAP,OAFD,CAAP;AAGD;;AACD,QAAMC,QAAQ,GAAG,0BAAOL,KAAP,EAAcM,OAAO,CAACC,GAAR,CAAYC,UAA1B,CAAjB;;AACA,QAAI,CAACH,QAAL,EAAe;AACb,aAAOP,QAAQ,CACZI,MADI,CACG,GADH,EAEJC,IAFI,CAEC;AAAEC,QAAAA,GAAG,EAAE;AAAP,OAFD,CAAP;AAGD;;AACDP,IAAAA,OAAO,CAACY,IAAR,GAAeJ,QAAQ,CAACK,EAAxB;AACAX,IAAAA,IAAI;AACL,GAfD,CAeE,OAAOY,GAAP,EAAY;AACZC,IAAAA,GAAG,CAACV,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAAEU,MAAAA,KAAK,EAAEF,GAAG,CAACG;AAAb,KAArB;AACD;AACF,CAnBD","sourcesContent":["import { verify } from \"jsonwebtoken\";\r\n\r\nconst auth = (request, response, next) => {\r\n  try {\r\n    const token = request.header(\"x-access-token\");\r\n    if (!token) {\r\n      return response\r\n        .status(401)\r\n        .json({ msg: \"No authentication token, access denied\" });\r\n    }\r\n    const verified = verify(token, process.env.JWT_SECRET);\r\n    if (!verified) {\r\n      return response\r\n        .status(401)\r\n        .json({ msg: \"Token verification failed, authorization denied\" });\r\n    }\r\n    request.user = verified.id;\r\n    next();\r\n  } catch (err) {\r\n    res.status(500).json({ error: err.message });\r\n  }\r\n};\r\n\r\nexport { auth };\r\n"],"file":"auth.js"}